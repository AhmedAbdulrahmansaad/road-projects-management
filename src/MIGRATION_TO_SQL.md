# ๐๏ธ ุงูุงูุชูุงู ูู KV Store ุฅูู SQL Database

## โ ุชู ุจูุฌุงุญ!

ุชู ุชุญููู ุงููุธุงู ุจุงููุงูู ูู **KV Store** ุฅูู **PostgreSQL** ุนุจุฑ Supabase!

---

## ๐ ุงูุชุบููุฑุงุช ุงูุฑุฆูุณูุฉ:

### 1๏ธโฃ ูุงุนุฏุฉ ุงูุจูุงูุงุช:
- โ **ูุจู:** KV Store (Key-Value)
- โ **ุจุนุฏ:** PostgreSQL (Relational Database)

### 2๏ธโฃ ุงูุฌุฏุงูู ุงูููุดุฃุฉ:
```
โ users - ุงููุณุชุฎุฏููู
โ projects - ุงููุดุงุฑูุน
โ daily_reports - ุงูุชูุงุฑูุฑ ุงูููููุฉ
โ percentage_statements - ุจูุงู ุงููุณุจ
โ performance_contracts - ุนููุฏ ุงูุฃุฏุงุก
โ notifications - ุงูุฅุดุนุงุฑุงุช
```

### 3๏ธโฃ ุงููุฒุงูุง ุงูุฌุฏูุฏุฉ:
- ๐ **Row Level Security (RLS)** ููุฃูุงู
- ๐ **Foreign Keys** ูุถูุงู ุณูุงูุฉ ุงูุจูุงูุงุช
- โก **Indexes** ููุฃุฏุงุก ุงูุนุงูู
- โ **Constraints** ููุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
- ๐ **CASCADE DELETE** ููุญุฐู ุงูุชููุงุฆู
- ๐ **JOIN Queries** ููุนูุงูุงุช ุจูู ุงูุฌุฏุงูู

---

## ๐ค ุงููุณุงุนุฏ ุงูุฐูู - ุชุญุณููุงุช ุฌุฏูุฏุฉ:

### **ูุจู:**
- ูุณุงุนุฏ ุจุณูุท ูุน ุจูุงูุงุช ููููุฉ
- ููุณ ุงูุฑุฏ ููู ุงููุณุชุฎุฏููู

### **ุจุนุฏ:**
- โ **ูุณุงุนุฏ ุฐูู ุญูููู** ูุนูู ูุน ุงูุจูุงูุงุช ุงููุนููุฉ
- โ **ุฑุฏูุฏ ูุฎุตุตุฉ ุญุณุจ ุฏูุฑ ุงููุณุชุฎุฏู**:
  - **ุงููุฏูุฑ ุงูุนุงู:** ุฅุญุตุงุฆูุงุช ูุงููุฉ + ุชูุงุฑูุฑ ุดุงููุฉ
  - **ูุฏูุฑ ุนุงู ุงููุฑุน:** ุนุฑุถ ุงูุจูุงูุงุช ููุท
  - **ุงููููุฏุณ:** ุฅูุดุงุก ูุดุงุฑูุน ูุชูุงุฑูุฑ + ุนุฑุถ
  - **ุงููุฑุงูุจ:** ุนุฑุถ ููุท

---

## ๐ ุงูุตูุงุญูุงุช ุงููุญุฏุซุฉ:

### ุงููุฏูุฑ ุงูุนุงู (General Manager):
- โ ูู ุงูุตูุงุญูุงุช
- โ ุฅูุดุงุก/ุชุนุฏูู/ุญุฐู: ุงููุณุชุฎุฏูููุ ุงููุดุงุฑูุนุ ุงูุชูุงุฑูุฑุ ุนููุฏ ุงูุฃุฏุงุก
- โ ุงููุตูู ุงููุงูู ูููุณุงุนุฏ ุงูุฐูู

### ูุฏูุฑ ุนุงู ุงููุฑุน (Branch General Manager):
- โ ุนุฑุถ ูู ุงูุจูุงูุงุช
- โ ูุง ููููู ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
- โ ูุง ููููู ุงูุชุนุฏูู ุฃู ุงูุญุฐู

### ุงููุฏูุฑ ุงูุฅุฏุงุฑู (Admin Manager):
- โ ุนุฑุถ ูู ุงูุจูุงูุงุช
- โ ูุง ููููู ุงูุชุนุฏูู ุฃู ุงูุญุฐู

### ุงููููุฏุณ ุงููุดุฑู (Supervising Engineer):
- โ ุฅูุดุงุก ูุดุงุฑูุน ูุชูุงุฑูุฑ
- โ ุนุฑุถ ูู ุงูุจูุงูุงุช
- โ ูุง ููููู ุงูุญุฐู ุฃู ุงูุชุนุฏูู

### ุงููููุฏุณ (Engineer):
- โ ุฅูุดุงุก ูุดุงุฑูุน ูุชูุงุฑูุฑ
- โ ุนุฑุถ ูู ุงูุจูุงูุงุช
- โ ูุง ููููู ุงูุญุฐู ุฃู ุงูุชุนุฏูู

### ุงููุฑุงูุจ (Observer):
- โ ุนุฑุถ ููุท
- โ ูุง ููููู ุงูุฅูุดุงุก ุฃู ุงูุชุนุฏูู ุฃู ุงูุญุฐู

---

## ๐ ุงูุฅุดุนุงุฑุงุช:

### ูุจู:
- ุฅุดุนุงุฑุงุช ูุฎุฒูุฉ ูู KV Store

### ุจุนุฏ:
- โ ุฅุดุนุงุฑุงุช ูู ุฌุฏูู SQL
- โ ุฅุดุนุงุฑุงุช ูููู (user_id = null)
- โ ุฅุดุนุงุฑุงุช ูุฎุตุตุฉ (user_id = specific user)
- โ ุญุงูุฉ ุงููุฑุงุกุฉ (is_read)
- โ ุฃููุงุน ูุฎุชููุฉ (info, success, warning, error)

---

## ๐ ุงูุจูุงูุงุช:

### ูุจู:
```javascript
// KV Store
await kv.set('project:123', { data });
await kv.get('project:123');
await kv.getByPrefix('project:');
```

### ุจุนุฏ:
```javascript
// SQL Database
await supabaseAdmin
  .from('projects')
  .insert([{ data }]);

await supabaseAdmin
  .from('projects')
  .select('*')
  .eq('id', '123');
```

---

## ๐ ุฎุทูุงุช ุงูุชูุนูู:

### 1๏ธโฃ ุชู ุชูููุฐ ุฃููุงุฏ SQL ูู Supabase โ
### 2๏ธโฃ ุงูุฎุทูุฉ ุงูุชุงููุฉ:

**ุงุณุชุจุฏุงู ููู ุงูุณูุฑูุฑ:**

```bash
# ุงุญุฐู ุงูููู ุงููุฏูู (ุงุฎุชูุงุฑู - ุงุญุชูุธ ุจู ููุณุฎุฉ ุงุญุชูุงุทูุฉ)
# mv /supabase/functions/server/index.tsx /supabase/functions/server/index-old.tsx

# ุงุณุชุฎุฏู ุงูููู ุงูุฌุฏูุฏ
mv /supabase/functions/server/index-sql.tsx /supabase/functions/server/index.tsx
```

### 3๏ธโฃ ุงุฎุชุจุงุฑ ุงููุธุงู:
- ุชุณุฌูู ุฏุฎูู
- ุฅูุดุงุก ูุดุฑูุน
- ุฅูุดุงุก ุชูุฑูุฑ ูููู
- ุงุฎุชุจุงุฑ ุงููุณุงุนุฏ ุงูุฐูู
- ุงุฎุชุจุงุฑ ุงูุตูุงุญูุงุช

---

## ๐ฏ ุงููููุงุช ุงููุญุฏุซุฉ:

```
/sql-scripts/
  โโโ 01-drop-tables.sql
  โโโ 02-create-users.sql
  โโโ 03-create-projects.sql
  โโโ 04-create-daily-reports.sql
  โโโ 05-create-percentage-statements.sql
  โโโ 06-create-performance-contracts.sql
  โโโ 07-create-notifications.sql
  โโโ 08-enable-rls.sql
  โโโ 09-create-functions.sql
  โโโ README.md

/supabase/functions/server/
  โโโ index.tsx (ุงููุฏูู - ูุณุฎุฉ ุงุญุชูุงุทูุฉ)
  โโโ index-sql.tsx (ุงูุฌุฏูุฏ - SQL)
  โโโ kv_store.tsx (ูู ููุณุชุฎุฏู ุจุนุฏ ุงูุขู)
```

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ:

1. **ุงููุณุฎ ุงูุงุญุชูุงุทู:**
   - ุชู ุงูุงุญุชูุงุธ ุจุงูููู ุงููุฏูู: `index.tsx`
   - ุงูููู ุงูุฌุฏูุฏ: `index-sql.tsx`
   - ููููู ุงุณุชุจุฏุงููู ุนูุฏูุง ุชููู ุฌุงูุฒุงู

2. **ุงูุจูุงูุงุช ุงููุฏููุฉ:**
   - ุงูุจูุงูุงุช ูู KV Store ูู ุชูุญุฐู ุชููุงุฆูุงู
   - ููููู ุญุฐููุง ูุฏููุงู ุจุนุฏ ุงูุชุฃูุฏ ูู ูุฌุงุญ ุงูุงูุชูุงู

3. **ุงูุชุดููุฑ:**
   - ูููุงุช ุงููุฑูุฑ ูุดูุฑุฉ ุจุงุณุชุฎุฏุงู bcrypt
   - ุขููุฉ 100%

4. **ุงูุฃุฏุงุก:**
   - SQL ุฃุณุฑุน ุจูุซูุฑ ูู KV Store
   - Indexes ุชุญุณู ุงูุฃุฏุงุก
   - JOIN queries ุฃูุถู ูู multiple requests

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:

โ ูุธุงู ุญูููู 100% ูุน ูุงุนุฏุฉ ุจูุงูุงุช SQL
โ ูุณุงุนุฏ ุฐูู ูุนูู ุญุณุจ ุฏูุฑ ุงููุณุชุฎุฏู
โ ุตูุงุญูุงุช ุฏูููุฉ ููู ุฏูุฑ
โ ุฃูุงู ุนุงูู ูุน RLS
โ ุฃุฏุงุก ููุชุงุฒ
โ ุฌุงูุฒ ููุฅูุชุงุฌ

---

## ๐ ุงูุฎุทูุฉ ุงูุชุงููุฉ:

**ุฃุฎุจุฑูู ุนูุฏูุง ุชููู ุฌุงูุฒุงู ูุงุณุชุจุฏุงู ุงูููู ูุชูุนูู ุงููุธุงู ุงูุฌุฏูุฏ!** ๐
